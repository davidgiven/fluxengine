This is a heavily truncated copy of https://github.com/foonathan/lexy, commit
20926cf.