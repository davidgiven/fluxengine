from build.pkg import package
from build.c import clibrary
from build.git import git_repository

package(
    name="md4c_lib",
    package="md4c",
    fallback=clibrary(
        name="md4c_fallback_lib",
        srcs=[
            "dep/md4c/src/entity.c",
            "dep/md4c/src/entity.h",
            "dep/md4c/src/md4c-html.h",
            "dep/md4c/src/md4c.c",
            "dep/md4c/src/md4c.h",
        ],
        hdrs={"md4c.h": "dep/md4c/src/md4c.h"},
        deps=[
            git_repository(
                name="md4c_repo",
                url="https://github.com/mity/md4c",
                branch="master",
                path="dep/md4c",
            )
        ],
    ),
)

clibrary(
    name="lexy_lib",
    hdrs={
        h: f"dep/lexy/include/{h}"
        for h in [
            "lexy_ext/parse_tree_algorithm.hpp",
            "lexy_ext/report_error.hpp",
            "lexy_ext/parse_tree_doctest.hpp",
            "lexy_ext/compiler_explorer.hpp",
            "lexy_ext/shell.hpp",
            "lexy/callback/constant.hpp",
            "lexy/callback/object.hpp",
            "lexy/callback/composition.hpp",
            "lexy/callback/aggregate.hpp",
            "lexy/callback/forward.hpp",
            "lexy/callback/integer.hpp",
            "lexy/callback/string.hpp",
            "lexy/callback/bit_cast.hpp",
            "lexy/callback/bind.hpp",
            "lexy/callback/fold.hpp",
            "lexy/callback/adapter.hpp",
            "lexy/callback/container.hpp",
            "lexy/callback/noop.hpp",
            "lexy/callback/base.hpp",
            "lexy/error.hpp",
            "lexy/_detail/type_name.hpp",
            "lexy/_detail/assert.hpp",
            "lexy/_detail/swar.hpp",
            "lexy/_detail/tuple.hpp",
            "lexy/_detail/code_point.hpp",
            "lexy/_detail/unicode_database.hpp",
            "lexy/_detail/integer_sequence.hpp",
            "lexy/_detail/any_ref.hpp",
            "lexy/_detail/memory_resource.hpp",
            "lexy/_detail/iterator.hpp",
            "lexy/_detail/config.hpp",
            "lexy/_detail/stateless_lambda.hpp",
            "lexy/_detail/lazy_init.hpp",
            "lexy/_detail/nttp_string.hpp",
            "lexy/_detail/detect.hpp",
            "lexy/_detail/string_view.hpp",
            "lexy/_detail/buffer_builder.hpp",
            "lexy/_detail/invoke.hpp",
            "lexy/_detail/std.hpp",
            "lexy/code_point.hpp",
            "lexy/parse_tree.hpp",
            "lexy/grammar.hpp",
            "lexy/encoding.hpp",
            "lexy/input_location.hpp",
            "lexy/lexeme.hpp",
            "lexy/dsl/capture.hpp",
            "lexy/dsl/case_folding.hpp",
            "lexy/dsl/literal.hpp",
            "lexy/dsl/context_identifier.hpp",
            "lexy/dsl/error.hpp",
            "lexy/dsl/whitespace.hpp",
            "lexy/dsl/flags.hpp",
            "lexy/dsl/subgrammar.hpp",
            "lexy/dsl/code_point.hpp",
            "lexy/dsl/sign.hpp",
            "lexy/dsl/member.hpp",
            "lexy/dsl/if.hpp",
            "lexy/dsl/symbol.hpp",
            "lexy/dsl/branch.hpp",
            "lexy/dsl/follow.hpp",
            "lexy/dsl/repeat.hpp",
            "lexy/dsl/ascii.hpp",
            "lexy/dsl/combination.hpp",
            "lexy/dsl/return.hpp",
            "lexy/dsl/integer.hpp",
            "lexy/dsl/production.hpp",
            "lexy/dsl/until.hpp",
            "lexy/dsl/brackets.hpp",
            "lexy/dsl/sequence.hpp",
            "lexy/dsl/char_class.hpp",
            "lexy/dsl/lookahead.hpp",
            "lexy/dsl/loop.hpp",
            "lexy/dsl/unicode.hpp",
            "lexy/dsl/context_counter.hpp",
            "lexy/dsl/choice.hpp",
            "lexy/dsl/parse_as.hpp",
            "lexy/dsl/byte.hpp",
            "lexy/dsl/digit.hpp",
            "lexy/dsl/punctuator.hpp",
            "lexy/dsl/recover.hpp",
            "lexy/dsl/times.hpp",
            "lexy/dsl/bits.hpp",
            "lexy/dsl/option.hpp",
            "lexy/dsl/identifier.hpp",
            "lexy/dsl/context_flag.hpp",
            "lexy/dsl/operator.hpp",
            "lexy/dsl/token.hpp",
            "lexy/dsl/any.hpp",
            "lexy/dsl/separator.hpp",
            "lexy/dsl/peek.hpp",
            "lexy/dsl/newline.hpp",
            "lexy/dsl/parse_tree_node.hpp",
            "lexy/dsl/expression.hpp",
            "lexy/dsl/delimited.hpp",
            "lexy/dsl/effect.hpp",
            "lexy/dsl/position.hpp",
            "lexy/dsl/scan.hpp",
            "lexy/dsl/list.hpp",
            "lexy/dsl/base.hpp",
            "lexy/dsl/bom.hpp",
            "lexy/dsl/terminator.hpp",
            "lexy/dsl/eof.hpp",
            "lexy/dsl.hpp",
            "lexy/visualize.hpp",
            "lexy/callback.hpp",
            "lexy/token.hpp",
            "lexy/action/parse_as_tree.hpp",
            "lexy/action/parse.hpp",
            "lexy/action/trace.hpp",
            "lexy/action/match.hpp",
            "lexy/action/validate.hpp",
            "lexy/action/scan.hpp",
            "lexy/action/base.hpp",
            "lexy/input/buffer.hpp",
            "lexy/input/lexeme_input.hpp",
            "lexy/input/argv_input.hpp",
            "lexy/input/file.hpp",
            "lexy/input/string_input.hpp",
            "lexy/input/parse_tree_input.hpp",
            "lexy/input/range_input.hpp",
            "lexy/input/base.hpp",
        ]
    },
    deps=[
        git_repository(
            name="lexy_repo",
            url="https://github.com/foonathan/lexy",
            branch="v2025.05.0",
            path="dep/lexy",
        )
    ],
)
